<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MergePDF - Merge PDFs Online</title>
<meta name="description" content="Free online tool to merge multiple PDF files into one. Drag, reorder, and combine instantly.">
<meta name="keywords" content="merge pdf, combine pdf, pdf merger online, free pdf tool">
<meta name="author" content="YourName">

<!-- Schema for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "MergePDF",
  "url": "https://yourwebsite.com",
  "description": "Free online PDF merger tool with drag and drop support, thumbnails, and reordering.",
  "applicationCategory": "Utility",
  "operatingSystem": "Web"
}
</script>

<!-- Libraries -->
<script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(135deg, #0072ff, #00c6ff);
  color: #fff;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}
header {
  text-align: center;
  padding: 2rem 1rem;
}
h1 {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}
main {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}
.upload-section {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 15px;
  padding: 2rem;
  width: 90%;
  max-width: 600px;
  text-align: center;
  transition: 0.3s;
}
.upload-section.dragover {
  border: 2px dashed #00ffea;
}
.file-preview {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 1rem;
}
.file-thumb {
  background: rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  margin: 0.5rem;
  padding: 0.5rem;
  width: 100px;
  cursor: grab;
  transition: transform 0.2s;
}
.file-thumb.dragging {
  opacity: 0.5;
  transform: scale(0.9);
}
.file-thumb canvas {
  width: 100%;
  border-radius: 4px;
}
.progress-container {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  height: 10px;
  margin: 1rem 0;
}
.progress-bar {
  height: 100%;
  width: 0%;
  background: #00ffea;
  border-radius: 10px;
  transition: width 0.3s;
}
button {
  padding: 0.8rem 1.5rem;
  border: none;
  border-radius: 10px;
  background: #ff9800;
  color: #000;
  cursor: pointer;
  font-weight: bold;
}
button:hover {
  background: #ffa733;
}
#downloadLink {
  display: none;
  background: #00e676;
  color: #000;
  text-decoration: none;
  padding: 1rem 2rem;
  border-radius: 10px;
  font-weight: bold;
}
footer {
  text-align: center;
  padding: 1rem;
  background: rgba(0,0,0,0.2);
}
</style>
</head>
<body>
<header>
  <h1>MergePDF</h1>
  <p>Upload, reorder, and merge PDFs â€” instantly!</p>
</header>

<main>
  <div class="upload-section" id="dropArea">
    <input type="file" id="pdfFiles" accept="application/pdf" multiple hidden>
    <p>Drag & Drop PDF files here or <label for="pdfFiles" style="color:#00e6ff; cursor:pointer;">Browse</label></p>
    <div id="filePreview" class="file-preview"></div>
    <div class="progress-container"><div id="progressBar" class="progress-bar"></div></div>
    <button id="mergeBtn">Merge PDFs</button>
    <a id="downloadLink" download="merged.pdf">Download Merged PDF</a>
  </div>
</main>

<footer><p>&copy; 2025 MergePDF. All rights reserved.</p></footer>

<script>
const { PDFDocument } = PDFLib;
const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

const dropArea = document.getElementById('dropArea');
const fileInput = document.getElementById('pdfFiles');
const previewContainer = document.getElementById('filePreview');
const progressBar = document.getElementById('progressBar');
const mergeBtn = document.getElementById('mergeBtn');
const downloadLink = document.getElementById('downloadLink');

let filesList = [];

// Drag & Drop Upload
['dragenter','dragover'].forEach(ev => dropArea.addEventListener(ev, e => {
  e.preventDefault(); dropArea.classList.add('dragover');
}));
['dragleave','drop'].forEach(ev => dropArea.addEventListener(ev, e => {
  e.preventDefault(); dropArea.classList.remove('dragover');
}));
dropArea.addEventListener('drop', e => handleFiles(e.dataTransfer.files));
fileInput.addEventListener('change', e => handleFiles(e.target.files));

async function handleFiles(files) {
  for (let file of files) {
    if (file.type !== 'application/pdf') continue;
    filesList.push(file);

    const thumb = document.createElement('div');
    thumb.className = 'file-thumb';
    thumb.draggable = true;

    const canvas = document.createElement('canvas');
    const name = document.createElement('div');
    name.textContent = file.name;
    thumb.append(canvas, name);
    previewContainer.appendChild(thumb);

    renderThumbnail(file, canvas);

    thumb.addEventListener('dragstart', () => thumb.classList.add('dragging'));
    thumb.addEventListener('dragend', () => {
      thumb.classList.remove('dragging');
      reorderFiles();
    });
  }
}

// Render thumbnail
async function renderThumbnail(file, canvas) {
  const arrayBuffer = await file.arrayBuffer();
  const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
  const page = await pdf.getPage(1);
  const viewport = page.getViewport({ scale: 0.3 });
  const ctx = canvas.getContext('2d');
  canvas.width = viewport.width;
  canvas.height = viewport.height;
  await page.render({ canvasContext: ctx, viewport }).promise;
}

// Reordering logic
previewContainer.addEventListener('dragover', e => {
  e.preventDefault();
  const dragging = document.querySelector('.dragging');
  const after = getDragAfterElement(previewContainer, e.clientX);
  if (!after) previewContainer.appendChild(dragging);
  else previewContainer.insertBefore(dragging, after);
});

function getDragAfterElement(container, x) {
  const els = [...container.querySelectorAll('.file-thumb:not(.dragging)')];
  return els.reduce((closest, child) => {
    const box = child.getBoundingClientRect();
    const offset = x - box.left - box.width / 2;
    if (offset < 0 && offset > closest.offset)
      return { offset, element: child };
    return closest;
  }, { offset: Number.NEGATIVE_INFINITY }).element;
}

function reorderFiles() {
  const newList = [];
  previewContainer.querySelectorAll('.file-thumb div:first-of-type').forEach(el => {
    const name = el.textContent;
    const file = filesList.find(f => f.name === name);
    if (file) newList.push(file);
  });
  filesList = newList;
}

// Merge PDFs
mergeBtn.addEventListener('click', async () => {
  if (filesList.length < 2) return alert('Select at least two PDFs.');
  const mergedPdf = await PDFDocument.create();
  let progress = 0, step = 100 / filesList.length;

  for (let file of filesList) {
    const pdf = await PDFDocument.load(await file.arrayBuffer());
    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
    pages.forEach(p => mergedPdf.addPage(p));
    progress += step;
    progressBar.style.width = progress + '%';
  }

  const blob = new Blob([await mergedPdf.save()], { type: 'application/pdf' });
  downloadLink.href = URL.createObjectURL(blob);
  downloadLink.style.display = 'inline-block';
});
</script>
</body>
</html>
